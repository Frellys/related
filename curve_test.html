<!DOCTYPE html>
<html>
<head>
    <title>curve_test</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        html {
            user-select: none;
            overflow: hidden;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: gray;
            display: table-cell;
            height: 100vh;
            width: 100vw;
            vertical-align: middle;
        }

            body > #wrap {
                position: absolute;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
            }

                body > #wrap > #left {
                    display: inline-block;
                    width: 30vw;
                    height: 100vh;
                    background-color: rgba(50, 50, 50, 0.25);
                }

                body > #wrap > #right {
                    display: inline-block;
                    width: 70vw;
                    height: 100vh;
                    background-color: rgba(102, 51, 153, 0.25);
                }
    </style>
</head>
<body>
    <div id="wrap">
        <div id="left"></div>
        <div id="right"></div>
    </div>
    <script>
        let App = new (function () {
            this.fps = 50;
            this.width = window.innerWidth;
            this.height = window.innerHeight;
            this.vmax = Math.max(this.width, this.height) / 100;
            this.vmin = Math.min(this.width, this.height) / 100;
            this.render_queue = [];
            this.cnv = document.createElement('canvas');
            this.cnv.width = this.width;
            this.cnv.height = this.height;
            document.body.appendChild(this.cnv);
            this.ctx = this.cnv.getContext('2d');
            this.Start = function () {
                // background
                this.background = new Background();
                this.render_queue.push(this.background);
                // menu
                this.menu = new Menu();
                this.render_queue.push(this.menu);
                window.addEventListener('keyup', function (e) {
                    if (e.key == 'Escape') {
                        App.menu.wrap.style.display = (App.menu.isOpened) ? 'none' : 'flex';
                        App.menu.isOpened = !App.menu.isOpened;
                    }
                }, false);
                // mouse
                this.mouse = new Mouse();
                this.render_queue.push(this.mouse);
                window.addEventListener('mousemove', function (e) {
                    App.mouse.x = e.x;
                    App.mouse.y = e.y;
                }, false);
                window.addEventListener('click', function () {
                    App.mouse.click = true;
                }, false);
                // logo
                this.logo = new Logo();
                this.render_queue.push(this.logo);
                // timer
                this.timer = new Timer();
                this.render_queue.push(this.timer);
            };
        })();
        class Timer {
            constructor() {
                this.render = setInterval(function () {
                    App.render_queue.forEach(function (el) {
                        el.Draw();
                    });
                    App.mouse.click = false;
                }, 1000 / App.fps);
            }
            Draw() {
                App.ctx.font = (App.vmin * 3) + 'px monospace';
                App.ctx.fillStyle = '#323232';
                App.ctx.textAlign = 'end';
                App.ctx.textBaseline = 'top';
                let dt = new Date();
                let hh = dt.getHours().toString().padStart(2, '0');
                let mm = dt.getMinutes().toString().padStart(2, '0');
                App.ctx.fillText(hh + ':' + mm, App.width - App.vmin, App.vmin);
            }
        }
        class Background {
            constructor() {
                this.fillStyle = 'whitesmoke';
            }
            Draw() {
                App.ctx.clearRect(0, 0, App.width, App.height);
                App.ctx.fillStyle = this.fillStyle;
                App.ctx.fillRect(0, 0, App.width, App.height);
            }
        }
        class Menu {
            constructor() {
                this.isOpened = false;
                this.wrap = document.querySelector('body > div#wrap');
                this.wrap.style.display = 'none';
            }
            Draw() {
                if (!this.isOpened) {
                    App.ctx.font = (App.vmin * 3) + 'px monospace';
                    App.ctx.fillStyle = '#323232';
                    App.ctx.textAlign = 'start';
                    App.ctx.textBaseline = 'top';
                    App.ctx.fillText('esc', App.vmin, App.vmin);
                }
            }
        }
        class Mouse {
            constructor() {
                this.x = 0;
                this.y = 0;
                this.click = false;
                this.pad = Math.max(window.screen.width, window.screen.height).toString().length;
            }
            Draw() {
                App.ctx.font = (App.vmin * 1.5) + 'px monospace';
                App.ctx.fillStyle = '#323232';
                App.ctx.textAlign = 'start';
                App.ctx.textBaseline = 'alphabetic';
                let x = App.mouse.x.toString().padStart(App.mouse.pad, '0');
                let y = App.mouse.y.toString().padStart(App.mouse.pad, '0');
                App.ctx.fillText(x, App.vmin, App.height - App.vmin * 2.5);
                App.ctx.fillText(y, App.vmin, App.height - App.vmin);
            }
        }
        class Logo {
            constructor() { }
            Draw() {
                App.ctx.font = (App.vmin * 10) + 'px monospace';
                App.ctx.fillStyle = '#323232';
                App.ctx.textAlign = 'center';
                App.ctx.textBaseline = 'middle';
                App.ctx.fillText('<sometext>', App.width / 2, App.height / 2);
            }
        }
        class Level {
            constructor(rows, cols) {

            }
        }
        window.addEventListener('resize', function () {
            App.width = window.innerWidth;
            App.height = window.innerHeight;
            App.vmax = Math.max(App.width, App.height) / 100;
            App.vmin = Math.min(App.width, App.height) / 100;
            App.cnv.width = App.width;
            App.cnv.height = App.height;
        }, false);
        window.addEventListener('load', function () {
            App.Start();
            console.log(App);
        }, { once: true });
    </script>
</body>
</html>